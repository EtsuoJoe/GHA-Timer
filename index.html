<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro HIIT</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        /* --- CSS STYLES --- */
        :root {
            --crt-green: #39ff14; 
        }

        body {
            background-color: #111;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            font-family: 'VT323', monospace;
            color: var(--crt-green);
        }

        #game-container {
            position: relative;
            width: 100%;
            max-width: 800px; 
        }

        #bg-image {
            width: 100%;
            height: auto;
            display: block;
        }

        /* --- THE TIMER OVERLAY --- */
        #crt-screen {
            position: absolute;
            
            /* YOUR CUSTOM ALIGNMENT SETTINGS */
            top: 46%;
            left: 14%;
            width: 70%;
            height: 40%;
            /* --------------------------- */

            /* TRANSPARENCY FIX:
               Changed from rgba(...) to transparent so we don't cover the fingers */
            background-color: transparent; 
            
            display: flex;
            flex-direction: column;
            justify-content: center; /* Centers content vertically */
            align-items: center;     /* Centers content horizontally */
            
            /* Debug border - remove the line below when perfectly happy! */
            /* border: 1px solid red; */
            
            text-shadow: 0 0 4px var(--crt-green); /* Slight glow */
        }

        /* SETUP SCREEN STYLES */
        #setup-area {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .setup-controls {
            display: flex;
            justify-content: space-evenly;
            width: 100%;
            font-size: 3vw; 
            margin-bottom: 2%; /* Spacing between inputs and start button */
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        input[type="number"] {
            background: rgba(0, 0, 0, 0.6); /* Semi-transparent background for readability */
            border: 1px solid var(--crt-green);
            color: var(--crt-green);
            font-family: 'VT323', monospace;
            font-size: 3vw; 
            width: 9vw;
            text-align: center;
        }

        /* RETRO CHECKBOX STYLES */
        .checkbox-group {
             display: flex;
             flex-direction: column;
             align-items: center;
             font-size: 2.5vw;
             cursor: pointer;
        }
        
        /* Hide the default messy browser checkbox */
        input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 3vw;
            height: 3vw;
            background-color: rgba(0,0,0,0.6);
            border: 2px solid var(--crt-green);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-top: 5px;
        }
        
        /* When checked, fill it with green or show an X */
        input[type="checkbox"]:checked {
            background-color: var(--crt-green);
            box-shadow: inset 0 0 5px #000;
        }
        
        /* Optional: Add an 'X' or checkmark inside via pseudo-element */
        input[type="checkbox"]:checked::after {
            content: '';
            display: block;
            width: 1.5vw;
            height: 1.5vw;
            background-color: black; 
        }

        /* WORKOUT SCREEN STYLES */
        #workout-area {
            height: 100%; 
            width: 100%;
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; /* Spreads items to top/center/bottom */
            align-items: center;
            padding: 1% 0; /* Tiny padding to prevent edge touching */
        }

        #rounds-tracker {
            font-size: 3vw;
            text-align: center;
            margin-top: 1%; /* Pushes it down slightly from top bezel */
        }

        #main-display {
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            line-height: 1; /* Tights line height to prevent gaps */
        }

        #status-label {
            font-size: 5vw; 
            text-align: center;
            text-transform: uppercase;
        }

        #time-remaining {
            /* OVERFLOW FIX: Reduced size from 14vw to 10vw to fit the 40% height */
            font-size: 11vw; 
            line-height: 0.9;
            text-align: center;
            margin-bottom: 2%;
        }

        /* Buttons */
        button {
            background: var(--crt-green);
            color: black;
            border: none;
            font-family: 'VT323', monospace;
            font-size: 3.5vw;
            padding: 0.5% 3%;
            cursor: pointer;
            text-transform: uppercase;
            margin-bottom: 1%; /* Keeps it off the absolute bottom edge */
        }
        
        button:hover {
            background: white;
        }
        
        .hidden { display: none !important; }

        @keyframes fast-blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        .blinking { animation: fast-blink 0.5s infinite; color: orange !important; }

    </style>
</head>
<body>

    <div id="game-container">
        <img src="bg.png" id="bg-image" alt="Retro TV Background">

        <div id="crt-screen">
            
            <div id="setup-area">
                <div class="setup-controls">
                    <div class="input-group">
                        <label>WORK</label>
                        <input type="number" id="work-in" value="30">
                    </div>
                    <div class="input-group">
                        <label>REST</label>
                        <input type="number" id="rest-in" value="10">
                    </div>
                    <div class="input-group">
                        <label>RNDS</label>
                        <input type="number" id="rounds-in" value="8">
                    </div>
                    <label class="checkbox-group">
                        DELAY
                        <input type="checkbox" id="delay-in" checked>
                    </label>
                </div>
                <div style="text-align: center;">
                    <button id="start-btn">INITIALIZE</button>
                </div>
            </div>

            <div id="workout-area" class="hidden">
                 <div id="rounds-tracker">RND: <span id="curr-round">1</span>/<span id="total-rounds-disp">8</span></div>
                 
                 <div id="main-display">
                    <div id="status-label">READY</div>
                    <div id="time-remaining">00</div>
                 </div>

                 <div style="text-align: center;">
                    <button id="reset-btn">RESET</button>
                 </div>
            </div>

        </div>
    </div>

    <script>
        let workSecs, restSecs, totalRounds;
        let currentRound = 1;
        let isWorking = true;
        let isDelaying = false;
        let timeLeft;
        let timerInterval;

        const setupArea = document.getElementById('setup-area');
        const workoutArea = document.getElementById('workout-area');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const statusLabel = document.getElementById('status-label');
        const timeDisplay = document.getElementById('time-remaining');
        const currRoundDisp = document.getElementById('curr-round');
        const totalRoundsDisp = document.getElementById('total-rounds-disp');
        const delayCheck = document.getElementById('delay-in');

        function formatTime(seconds) { return seconds < 10 ? `0${seconds}` : seconds; }
        function updateDisplay() { timeDisplay.textContent = formatTime(timeLeft); }

        function switchMode() {
            if (isDelaying) {
                isDelaying = false;
                statusLabel.classList.remove('blinking');
                startActualWorkRound();
                return;
            }
            if (!isWorking) {
                currentRound++;
                currRoundDisp.textContent = currentRound;
            }
            if (currentRound > totalRounds) {
                clearInterval(timerInterval);
                statusLabel.textContent = "DONE!";
                statusLabel.style.color = "var(--crt-green)";
                timeDisplay.textContent = "END";
                return;
            }
            isWorking = !isWorking;
            if (isWorking) {
                setStatus("WORK!", "var(--crt-green)");
                timeLeft = workSecs;
            } else {
                setStatus("REST...", "#ffff00");
                timeLeft = restSecs;
            }
            updateDisplay();
        }

        function setStatus(text, color) {
            statusLabel.textContent = text;
            statusLabel.style.color = color;
        }

        function startActualWorkRound() {
            isWorking = true;
            setStatus("WORK!", "var(--crt-green)");
            timeLeft = workSecs;
            updateDisplay();
        }

        function tick() {
            timeLeft--;
            updateDisplay();
            if (timeLeft <= 0) switchMode();
        }

        function startWorkout() {
            workSecs = parseInt(document.getElementById('work-in').value);
            restSecs = parseInt(document.getElementById('rest-in').value);
            totalRounds = parseInt(document.getElementById('rounds-in').value);
            
            if(workSecs < 1 || restSecs < 1 || totalRounds < 1) return;

            currentRound = 1;
            totalRoundsDisp.textContent = totalRounds;
            currRoundDisp.textContent = currentRound;
            
            setupArea.classList.add('hidden');
            workoutArea.classList.remove('hidden');

            if (delayCheck.checked) {
                isDelaying = true;
                timeLeft = 5;
                setStatus("PREP", "orange");
                statusLabel.classList.add('blinking');
            } else {
                isDelaying = false;
                startActualWorkRound();
            }
            
            updateDisplay();
            timerInterval = setInterval(tick, 1000);
        }

        function resetWorkout() {
            clearInterval(timerInterval);
            statusLabel.classList.remove('blinking');
            workoutArea.classList.add('hidden');
            setupArea.classList.remove('hidden');
        }

        startBtn.addEventListener('click', startWorkout);
        resetBtn.addEventListener('click', resetWorkout);
    </script>
</body>
</html>
